{% load static %}
<!DOCTYPE html>
<html lang="en">

<head>
	<base href="">
	<title>Proyect</title>
	<meta name="csrf-token" content="{{ csrf_token }}">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">

	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Poppins:300,400,500,600,700" />

	<link href="{% static 'css/jquery-ui.css' %}" rel="stylesheet" type="text/css" />

	<!-- <link href="{% static 'css/fullcalendar/fullcalendar.bundle.css' %}" rel="stylesheet" type="text/css" /> -->
	<link href="{% static 'css/plugins.bundle.css' %}" rel="stylesheet" type="text/css" />
	<link href="{% static 'css/style.bundle.css' %}" rel="stylesheet" type="text/css" />

	

	<link href="{% static 'css/galery/gallery.css' %}" rel="stylesheet" type="text/css" />
	<link href="{% static 'css/galery/jquery.fancybox.css' %}" rel="stylesheet" type="text/css" />
	

	<!--end::Global Stylesheets Bundle-->

	<style>
		.preview {
			width: 100px;
			height: 100px;
			object-fit: cover;
			/* margin-top: 20px; */
			margin-right: 10px;
		}

		.image-container {
			display: flex;
			flex-wrap: wrap;
		}				
		

	</style>

</head>
<!--end::Head-->
<!--begin::Body-->

<body id="kt_body" class="header-fixed header-tablet-and-mobile-fixed toolbar-enabled toolbar-fixed"
	style="--kt-toolbar-height:190px;--kt-toolbar-height-tablet-and-mobile:55px">
	<!--begin::Main-->
	<!--begin::Root-->
	<div class="d-flex flex-column flex-root">
		<!--begin::Page-->
		<div class="page d-flex flex-row flex-column-fluid">
			<!--begin::Wrapper-->
			<div class="wrapper d-flex flex-column flex-row-fluid" id="kt_wrapper">

				<!--begin::Header-->
				{% include 'header.html' %}
				<!--end::Header-->

				<!--begin::Content-->
				<div class="content d-flex flex-column flex-column-fluid" id="kt_content" style="margin-top: -25px;">

					<!--begin::Toolbar-->
					<div class="toolbar" style="background-color: #EFF2F5;">

						{% if messages %}
								<div class="alert alert-dismissible fade show" role="alert">
									{% for message in messages %}
									<div class="alert alert-{{ message.tags }}">
										{{ message }}
									</div>
									{% endfor %}
								</div>
								{% endif %}


								<div class="d-flex flex-column-fluid" style="margin-top: 2px;">
									<!--begin::Container-->
									<div id="kt_content_container" class="container-xxl">
										<!--begin::Card-->
							
											{% if labels.TITLE_PROYECT_VIEW != None %}
											<div class="card-header pt-5">
												<h3 class="card-title align-items-start flex-column" >
													<span class="card-label fw-bolder fs-3 mb-1">{{ labels.TITLE_PROYECT_VIEW }}</span>
													{% if labels.SUBTITLE_PROYECT_VIEW != None %}
												<span class="text-muted mt-1 fw-bold fs-7">{{ labels.SUBTITLE_PROYECT_VIEW }}</span>
												{% endif %}
												</h3>
											</div>
											{% endif %}
										

										<div class="card-footer" >
											<div class="card-body p-5">

												<div class="row mb-0">
										
		
													<div class="col-lg-9" style="border:1px solid white; border-width:1px;" >
																									
														<div class="mr-1">
															<!--begin::Name-->
															<h3>{{ customer.address}}
																{% if customer.apartment != None and customer.apartment != "" %}
																,{{customer.apartment }}{% endif %}
																{% if customer.city != None and customer.city != "" %}
																,{{customer.city }}{% endif %}
																{% if customer.state != None and customer.state != "" %}
																,{{customer.state }}{% endif %}
																{% if customer.zipcode != None and customer.zipcode != "" %}
																,{{customer.zipcode }}{% endif %}
															</h3>
															<!--end::Name-->
															<div class="row">												
			
																<div class="col-lg-6" style="border:1px solid white; border-width:1px;">
																	<div class="row">
																		<div class="col-xl-12">																		
																			<span class="svg-icon svg-icon-4 me-1">
																				<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none">
																					<path opacity="0.3" d="M22 12C22 17.5 17.5 22 12 22C6.5 22 2 17.5 2 12C2 6.5 6.5 2 12 2C17.5 2 22 6.5 22 12ZM12 7C10.3 7 9 8.3 9 10C9 11.7 10.3 13 12 13C13.7 13 15 11.7 15 10C15 8.3 13.7 7 12 7Z" fill="black"></path>
																					<path d="M12 22C14.6 22 17 21 18.7 19.4C17.9 16.9 15.2 15 12 15C8.8 15 6.09999 16.9 5.29999 19.4C6.99999 21 9.4 22 12 22Z" fill="black"></path>
																				</svg>
																			</span>
																			{{ customer.name}}
																		</div>
																	</div>
																	<div class="row">
																		<div class="col-xl-12">																		
																			<span class="svg-icon svg-icon-4 me-1">
																				<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none">
																					<path opacity="0.3" d="M18.0624 15.3453L13.1624 20.7453C12.5624 21.4453 11.5624 21.4453 10.9624 20.7453L6.06242 15.3453C4.56242 13.6453 3.76242 11.4453 4.06242 8.94534C4.56242 5.34534 7.46242 2.44534 11.0624 2.04534C15.8624 1.54534 19.9624 5.24534 19.9624 9.94534C20.0624 12.0453 19.2624 13.9453 18.0624 15.3453Z" fill="black"></path>
																						<path d="M12.0624 13.0453C13.7193 13.0453 15.0624 11.7022 15.0624 10.0453C15.0624 8.38849 13.7193 7.04535 12.0624 7.04535C10.4056 7.04535 9.06241 8.38849 9.06241 10.0453C9.06241 11.7022 10.4056 13.0453 12.0624 13.0453Z" fill="black"></path>
																				</svg>
																			</span>
																			{{ customer.phone}}
																		</div>																	
																	</div>
																	<div class="row">
																		<div class="col-xl-12">																		
																			<span class="svg-icon svg-icon-4 me-1">
																				<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none">
																					<path opacity="0.3" d="M21 19H3C2.4 19 2 18.6 2 18V6C2 5.4 2.4 5 3 5H21C21.6 5 22 5.4 22 6V18C22 18.6 21.6 19 21 19Z" fill="black"></path>
																						<path d="M21 5H2.99999C2.69999 5 2.49999 5.10005 2.29999 5.30005L11.2 13.3C11.7 13.7 12.4 13.7 12.8 13.3L21.7 5.30005C21.5 5.10005 21.3 5 21 5Z" fill="black"></path>
																				</svg>
																			</span>
																			{{ customer.email}}
																		</div>																	
																	</div>
																</div>
			
			
																{% for decorator in decorators %}
			
																<div class="col-lg-6" style="border:1px solid white; border-width:1px;">
																	<div class="row">
																		<div class="col-xl-12">																		
																			<span class="svg-icon svg-icon-4 me-1">
																				<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none">
																					<path opacity="0.3" d="M22 12C22 17.5 17.5 22 12 22C6.5 22 2 17.5 2 12C2 6.5 6.5 2 12 2C17.5 2 22 6.5 22 12ZM12 7C10.3 7 9 8.3 9 10C9 11.7 10.3 13 12 13C13.7 13 15 11.7 15 10C15 8.3 13.7 7 12 7Z" fill="black"></path>
																					<path d="M12 22C14.6 22 17 21 18.7 19.4C17.9 16.9 15.2 15 12 15C8.8 15 6.09999 16.9 5.29999 19.4C6.99999 21 9.4 22 12 22Z" fill="black"></path>
																				</svg>
																			</span>
																			{{ decorator.name}}
																		</div>																	
																	</div>
																	<div class="row">
																		<div class="col-xl-12">																		
																			<span class="svg-icon svg-icon-4 me-1">
																				<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none">
																					<path opacity="0.3" d="M18.0624 15.3453L13.1624 20.7453C12.5624 21.4453 11.5624 21.4453 10.9624 20.7453L6.06242 15.3453C4.56242 13.6453 3.76242 11.4453 4.06242 8.94534C4.56242 5.34534 7.46242 2.44534 11.0624 2.04534C15.8624 1.54534 19.9624 5.24534 19.9624 9.94534C20.0624 12.0453 19.2624 13.9453 18.0624 15.3453Z" fill="black"></path>
																						<path d="M12.0624 13.0453C13.7193 13.0453 15.0624 11.7022 15.0624 10.0453C15.0624 8.38849 13.7193 7.04535 12.0624 7.04535C10.4056 7.04535 9.06241 8.38849 9.06241 10.0453C9.06241 11.7022 10.4056 13.0453 12.0624 13.0453Z" fill="black"></path>
																				</svg>
																			</span>
																			{{ decorator.phone}}
																		</div>																	
																	</div>
																	<div class="row">
																		<div class="col-xl-12">																		
																			<span class="svg-icon svg-icon-4 me-1">
																				<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none">
																					<path opacity="0.3" d="M21 19H3C2.4 19 2 18.6 2 18V6C2 5.4 2.4 5 3 5H21C21.6 5 22 5.4 22 6V18C22 18.6 21.6 19 21 19Z" fill="black"></path>
																						<path d="M21 5H2.99999C2.69999 5 2.49999 5.10005 2.29999 5.30005L11.2 13.3C11.7 13.7 12.4 13.7 12.8 13.3L21.7 5.30005C21.5 5.10005 21.3 5 21 5Z" fill="black"></path>
																				</svg>
																			</span>
																			{{ decorator.email}}
																		</div>																	
																	</div>
																</div>
														
																{% endfor %}
															</div>
														</div>														
													</div>
													
													
												</div>	
												
												
												
												
											</div>
										</div>
									</div>
								</div>
						
						
						
						

					</div>
					<!--end::Toolbar-->
					<!--begin::Entry-->
					<div class="d-flex flex-column-fluid" >
						<!--begin::Container-->						
						<div id="kt_content_container" class="container-xxl">
							<!--begin::Card-->
							<div class="card card-custom gutter-b" >
								
								<div class="card-body p-5" style="top:20px">
																									
									<div class="row mb-0">
										<div class="col-lg-12" style="border:1px solid white; border-width:1px;">


											<div class="d-flex align-items-center collapsible py-3 toggle collapsed mb-0" data-bs-toggle="collapse" data-bs-target="#divProjectDetail">
												<!--begin::Icon-->
												<div class="btn btn-sm btn-icon mw-20px btn-active-color-primary me-5">
													<!--begin::Svg Icon | path: icons/duotune/general/gen036.svg-->
													<span class="svg-icon toggle-on svg-icon-primary svg-icon-1">
														<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none">
															<rect opacity="0.3" x="2" y="2" width="20" height="20" rx="5" fill="black"></rect>
															<rect x="6.0104" y="10.9247" width="12" height="2" rx="1" fill="black"></rect>
														</svg>
													</span>
													<!--end::Svg Icon-->
													<!--begin::Svg Icon | path: icons/duotune/general/gen035.svg-->
													<span class="svg-icon toggle-off svg-icon-1">
														<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none">
															<rect opacity="0.3" x="2" y="2" width="20" height="20" rx="5" fill="black"></rect>
															<rect x="10.8891" y="17.8033" width="12" height="2" rx="1" transform="rotate(-90 10.8891 17.8033)" fill="black"></rect>
															<rect x="6.01041" y="10.9247" width="12" height="2" rx="1" fill="black"></rect>
														</svg>
													</span>
													<!--end::Svg Icon-->
												</div>
												<!--end::Icon-->
												<!--begin::Title-->
												<h6 class="text-gray-700 cursor-pointer mb-0">See more details</h6>
												<!--end::Title-->
											</div>

											<div id="divProjectDetail" class="fs-7 ms-1 collapse">
												<!--begin::Text-->
												{% if decoratorsHTML != '' %}
												<div class="mb-4 text-gray-600 fs-6 ps-10">
													<div class="d-flex align-items-center flex-wrap justify-content-between">
														<div class="card-title fs-6 fw-bolder">Decorators:</div>
														{{ decoratorsHTML|safe }}
														{% if ascociatesHTML != '' %}
															<br/>
															<div class="card-title fs-6 fw-bolder">Ascociates:</div>
															{{ ascociatesHTML|safe }}
														{% endif %}
													</div>
												</div>
												{% endif %}

												<div class="mb-4 text-gray-600 fs-7 ps-10">											
													<!--begin: Content-->
													<div class="d-flex align-items-center flex-wrap justify-content-between">
														<div class="flex-grow-1 font-weight-bold text-dark-50 py-5 py-lg-2 mr-5">
															{% if customer.description != '' %}
															<span class="svg-icon mr-3">
																<!--begin::Svg Icon | path:assets/media/svg/icons/Devices/Display1.svg-->
																<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="24px" height="24px" viewBox="0 0 24 24" version="1.1">
																	<g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
																		<rect x="0" y="0" width="24" height="24"/>
																		<path d="M12.2674799,18.2323597 L12.0084872,5.45852451 C12.0004303,5.06114792 12.1504154,4.6768183 12.4255037,4.38993949 L15.0030167,1.70195304 L17.5910752,4.40093695 C17.8599071,4.6812911 18.0095067,5.05499603 18.0083938,5.44341307 L17.9718262,18.2062508 C17.9694575,19.0329966 17.2985816,19.701953 16.4718324,19.701953 L13.7671717,19.701953 C12.9505952,19.701953 12.2840328,19.0487684 12.2674799,18.2323597 Z" fill="#000000" fill-rule="nonzero" transform="translate(14.701953, 10.701953) rotate(-135.000000) translate(-14.701953, -10.701953) "/>
																		<path d="M12.9,2 C13.4522847,2 13.9,2.44771525 13.9,3 C13.9,3.55228475 13.4522847,4 12.9,4 L6,4 C4.8954305,4 4,4.8954305 4,6 L4,18 C4,19.1045695 4.8954305,20 6,20 L18,20 C19.1045695,20 20,19.1045695 20,18 L20,13 C20,12.4477153 20.4477153,12 21,12 C21.5522847,12 22,12.4477153 22,13 L22,18 C22,20.209139 20.209139,22 18,22 L6,22 C3.790861,22 2,20.209139 2,18 L2,6 C2,3.790861 3.790861,2 6,2 L12.9,2 Z" fill="#000000" fill-rule="nonzero" opacity="0.3"/>
																	</g>
																</svg>
																<!--end::Svg Icon-->
															</span>
															<b>Address notes:</b> {{ customer.description}} <br/> {% endif %}
															{% if customer.notes != None %}
															<span class="svg-icon mr-3">
																<!--begin::Svg Icon | path:assets/media/svg/icons/Devices/Display1.svg-->
																<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="24px" height="24px" viewBox="0 0 24 24" version="1.1">
																	<g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
																		<rect x="0" y="0" width="24" height="24"/>
																		<path d="M12.2674799,18.2323597 L12.0084872,5.45852451 C12.0004303,5.06114792 12.1504154,4.6768183 12.4255037,4.38993949 L15.0030167,1.70195304 L17.5910752,4.40093695 C17.8599071,4.6812911 18.0095067,5.05499603 18.0083938,5.44341307 L17.9718262,18.2062508 C17.9694575,19.0329966 17.2985816,19.701953 16.4718324,19.701953 L13.7671717,19.701953 C12.9505952,19.701953 12.2840328,19.0487684 12.2674799,18.2323597 Z" fill="#000000" fill-rule="nonzero" transform="translate(14.701953, 10.701953) rotate(-135.000000) translate(-14.701953, -10.701953) "/>
																		<path d="M12.9,2 C13.4522847,2 13.9,2.44771525 13.9,3 C13.9,3.55228475 13.4522847,4 12.9,4 L6,4 C4.8954305,4 4,4.8954305 4,6 L4,18 C4,19.1045695 4.8954305,20 6,20 L18,20 C19.1045695,20 20,19.1045695 20,18 L20,13 C20,12.4477153 20.4477153,12 21,12 C21.5522847,12 22,12.4477153 22,13 L22,18 C22,20.209139 20.209139,22 18,22 L6,22 C3.790861,22 2,20.209139 2,18 L2,6 C2,3.790861 3.790861,2 6,2 L12.9,2 Z" fill="#000000" fill-rule="nonzero" opacity="0.3"/>
																	</g>
																</svg>
																<!--end::Svg Icon-->
															</span>
															<b>Client notes:</b> {{ customer.notes}} <br/> {% endif %}
															{% if proyect.description != None %}
															<span class="svg-icon mr-3">
																<!--begin::Svg Icon | path:assets/media/svg/icons/Devices/Display1.svg-->
																<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="24px" height="24px" viewBox="0 0 24 24" version="1.1">
																	<g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
																		<rect x="0" y="0" width="24" height="24"/>
																		<path d="M12.2674799,18.2323597 L12.0084872,5.45852451 C12.0004303,5.06114792 12.1504154,4.6768183 12.4255037,4.38993949 L15.0030167,1.70195304 L17.5910752,4.40093695 C17.8599071,4.6812911 18.0095067,5.05499603 18.0083938,5.44341307 L17.9718262,18.2062508 C17.9694575,19.0329966 17.2985816,19.701953 16.4718324,19.701953 L13.7671717,19.701953 C12.9505952,19.701953 12.2840328,19.0487684 12.2674799,18.2323597 Z" fill="#000000" fill-rule="nonzero" transform="translate(14.701953, 10.701953) rotate(-135.000000) translate(-14.701953, -10.701953) "/>
																		<path d="M12.9,2 C13.4522847,2 13.9,2.44771525 13.9,3 C13.9,3.55228475 13.4522847,4 12.9,4 L6,4 C4.8954305,4 4,4.8954305 4,6 L4,18 C4,19.1045695 4.8954305,20 6,20 L18,20 C19.1045695,20 20,19.1045695 20,18 L20,13 C20,12.4477153 20.4477153,12 21,12 C21.5522847,12 22,12.4477153 22,13 L22,18 C22,20.209139 20.209139,22 18,22 L6,22 C3.790861,22 2,20.209139 2,18 L2,6 C2,3.790861 3.790861,2 6,2 L12.9,2 Z" fill="#000000" fill-rule="nonzero" opacity="0.3"/>
																	</g>
																</svg>
																<!--end::Svg Icon-->
															</span>
															<b>Proyect description:</b> {{ proyect.description}} {% endif %}
														</div>
													</div>
													<!--end: Content-->
												</div>
												<!--end::Text-->
											</div>											
										</div>
									</div>
								</div>
							</div>
							<!--end::Card-->
							
							<div class="separator-dashed mt-4 mb-6"></div>

							<div id="messageSave">

							</div>

							<div id="wosDetails">

							{{ workOrdersHtml|safe }}

							</div>
							
							<!--begin::Modal Item-->
							<div class="post d-flex flex-column-fluid">
								<!--begin::Container-->
								<div class="container-xxl">
									<!--begin::Modal - Select Location-->
									<div class="modal fade " id="modalItem" tabindex="-1" >
										<!--begin::Modal dialog-->
										<div class="modal-dialog " style="max-width: 90% !important;">
											<!--begin::Modal content-->
											<div class="modal-content">
												<!--begin::Modal header-->
												<div class="modal-header">
													<!--begin::Title-->
													<h2>Item</h2>
													<!--end::Title-->
													<!--begin::Close-->
													<div class="btn btn-sm btn-icon btn-active-color-primary" data-bs-dismiss="modal">
														<span class="svg-icon svg-icon-1">
															<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none">
																<rect opacity="0.5" x="6" y="17.3137" width="16" height="2" rx="1" transform="rotate(-45 6 17.3137)" fill="black" />
																<rect x="7.41422" y="6" width="16" height="2" rx="1" transform="rotate(45 7.41422 6)" fill="black" />
															</svg>
														</span>
													</div>
													<!--end::Close-->
												</div>
												<!--end::Modal header-->
												<!--begin::Modal body-->
												<div class="modal-body">

													<div id="please_wait_message" style="display:none; text-align: center; padding: 20px;">
														<div class="spinner-border text-primary" role="status">
															<span class="sr-only">Loading...</span>
														</div>
														<span class="ml-2">Please wait, loading data...</span>
													</div>

													<form id="formItem" class="form" method="POST" enctype="multipart/form-data">
														<div id="divItem" class=""> <!--  class="card-body" -->
																																																		
															<!--begin::Row-->
															<div class="row">
																<!--begin::Col-->
																															
																	<div class="col-lg-6">
		
																		<div class="row mb-6">
		
																			<div class="col-xl-2">
																				<div class="fs-7 fw-bold mt-2 mb-3">Category:</div>
																			</div>
																			<!--end::Col-->
																			<!--begin::Col-->
																			<div class="col-xl-6 fv-row">
																				<!--begin::Input-->
		
																				<select id="selectCategory" class="form-select form-select-solid" name="category">
																					<option value="">---</option>
																					{% for category in categories %}
																					<option value="{{ category.id }}">{{ category.name }}</option>
																					{% endfor %}
																				</select>
		
																				<!--end::Input-->
																			</div>
																			<!--end::Col-->
		
																		</div>
		
																		<div class="row mb-6">
		
																			<!--begin::Col-->
																			<div class="col-xl-2">
																				<div class="fs-7 fw-bold mt-2 mb-3">Sub Category:</div>
																			</div>
																			<!--end::Col-->
																			<!--begin::Col-->
																			<div class="col-xl-6 fv-row">
																				<!--begin::Input-->
																			
																				<select id="selectSubcategory" class="form-select form-select-solid"
																					data-kt-select2="false" data-placeholder="Select"
																					data-allow-clear="true" name="subcategory">
																					<option value="">---</option>
																				</select>
																			
																				<!--end::Input-->
																			</div>
																			<!--end::Col-->
		
																		</div>
	
																		<div class="row mb-6">
		
																			<!--begin::Col-->
																			<div class="col-xl-2">
																				<div class="fs-7 fw-bold mt-2 mb-3">Group:</div>
																			</div>
																			<!--end::Col-->
																			<!--begin::Col-->
																			<div class="col-xl-6 fv-row">
																				<!--begin::Input-->
																			
																				<select id="selectGroup" class="form-select form-select-solid"
																					data-kt-select2="false" data-placeholder="Select"
																					data-allow-clear="true" name="group">
																					<option value="">---</option>
																				</select>
																			
																				<!--end::Input-->
																			</div>
																			<!--end::Col-->
		
																		</div>
		
																		<div class="row mb-6">
		
																			<!--begin::Col-->
																			<div class="col-xl-2">
																				<div class="fs-7 fw-bold mt-2 mb-3">Place:</div>
																			</div>
																			<!--end::Col-->
																			<!--begin::Col-->
																			<div class="col-xl-6 fv-row">
																				<!--begin::Input-->
		
																				<select id="selectPlace" class="form-select form-select-solid"
																					data-kt-select2="false" data-placeholder="Select"
																					data-allow-clear="true" name="place">
																					<option value="">---</option>
																					{% for place in places %}
																					<option value="{{ place.id }}">{{ place.name }}</option>
																					{% endfor %}
																				</select>
		
																				<!--end::Input-->
																			</div>
																			<!--end::Col-->
																		</div>
		
																		<div class="row mb-6">
		
																			<!--begin::Col-->
																			<div class="col-xl-2">
																				<div class="fs-7 fw-bold mt-2 mb-3">QTY:</div>
																			</div>
																			<!--end::Col-->
		
																			<div class="col-xl-6 fv-row">
																				<input id="inputQty" type="text" class="form-control form-control-solid" name="qty" value="" maxlength="100"/>
																			</div>
		
																		</div>
	
																		<div class="row mb-6">
																			<!--begin::Col-->
																			<div class="col-xl-2">																			
																				<div class="fs-7 fw-bold mt-2 mb-3">Proposed date:</div>
																			</div>
	
																			<div class="col-xl-6 fv-row">
																				<!--begin::Svg Icon | path: icons/duotune/general/gen014.svg-->
																				<span class="svg-icon position-absolute ms-4 mb-1 svg-icon-2">
																					<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
																						viewBox="0 0 24 24" fill="none">
																						<path opacity="0.3"
																							d="M21 22H3C2.4 22 2 21.6 2 21V5C2 4.4 2.4 4 3 4H21C21.6 4 22 4.4 22 5V21C22 21.6 21.6 22 21 22Z"
																							fill="black" />
																						<path
																							d="M6 6C5.4 6 5 5.6 5 5V3C5 2.4 5.4 2 6 2C6.6 2 7 2.4 7 3V5C7 5.6 6.6 6 6 6ZM11 5V3C11 2.4 10.6 2 10 2C9.4 2 9 2.4 9 3V5C9 5.6 9.4 6 10 6C10.6 6 11 5.6 11 5ZM15 5V3C15 2.4 14.6 2 14 2C13.4 2 13 2.4 13 3V5C13 5.6 13.4 6 14 6C14.6 6 15 5.6 15 5ZM19 5V3C19 2.4 18.6 2 18 2C17.4 2 17 2.4 17 3V5C17 5.6 17.4 6 18 6C18.6 6 19 5.6 19 5Z"
																							fill="black" />
																						<path
																							d="M8.8 13.1C9.2 13.1 9.5 13 9.7 12.8C9.9 12.6 10.1 12.3 10.1 11.9C10.1 11.6 10 11.3 9.8 11.1C9.6 10.9 9.3 10.8 9 10.8C8.8 10.8 8.59999 10.8 8.39999 10.9C8.19999 11 8.1 11.1 8 11.2C7.9 11.3 7.8 11.4 7.7 11.6C7.6 11.8 7.5 11.9 7.5 12.1C7.5 12.2 7.4 12.2 7.3 12.3C7.2 12.4 7.09999 12.4 6.89999 12.4C6.69999 12.4 6.6 12.3 6.5 12.2C6.4 12.1 6.3 11.9 6.3 11.7C6.3 11.5 6.4 11.3 6.5 11.1C6.6 10.9 6.8 10.7 7 10.5C7.2 10.3 7.49999 10.1 7.89999 10C8.29999 9.90003 8.60001 9.80003 9.10001 9.80003C9.50001 9.80003 9.80001 9.90003 10.1 10C10.4 10.1 10.7 10.3 10.9 10.4C11.1 10.5 11.3 10.8 11.4 11.1C11.5 11.4 11.6 11.6 11.6 11.9C11.6 12.3 11.5 12.6 11.3 12.9C11.1 13.2 10.9 13.5 10.6 13.7C10.9 13.9 11.2 14.1 11.4 14.3C11.6 14.5 11.8 14.7 11.9 15C12 15.3 12.1 15.5 12.1 15.8C12.1 16.2 12 16.5 11.9 16.8C11.8 17.1 11.5 17.4 11.3 17.7C11.1 18 10.7 18.2 10.3 18.3C9.9 18.4 9.5 18.5 9 18.5C8.5 18.5 8.1 18.4 7.7 18.2C7.3 18 7 17.8 6.8 17.6C6.6 17.4 6.4 17.1 6.3 16.8C6.2 16.5 6.10001 16.3 6.10001 16.1C6.10001 15.9 6.2 15.7 6.3 15.6C6.4 15.5 6.6 15.4 6.8 15.4C6.9 15.4 7.00001 15.4 7.10001 15.5C7.20001 15.6 7.3 15.6 7.3 15.7C7.5 16.2 7.7 16.6 8 16.9C8.3 17.2 8.6 17.3 9 17.3C9.2 17.3 9.5 17.2 9.7 17.1C9.9 17 10.1 16.8 10.3 16.6C10.5 16.4 10.5 16.1 10.5 15.8C10.5 15.3 10.4 15 10.1 14.7C9.80001 14.4 9.50001 14.3 9.10001 14.3C9.00001 14.3 8.9 14.3 8.7 14.3C8.5 14.3 8.39999 14.3 8.39999 14.3C8.19999 14.3 7.99999 14.2 7.89999 14.1C7.79999 14 7.7 13.8 7.7 13.7C7.7 13.5 7.79999 13.4 7.89999 13.2C7.99999 13 8.2 13 8.5 13H8.8V13.1ZM15.3 17.5V12.2C14.3 13 13.6 13.3 13.3 13.3C13.1 13.3 13 13.2 12.9 13.1C12.8 13 12.7 12.8 12.7 12.6C12.7 12.4 12.8 12.3 12.9 12.2C13 12.1 13.2 12 13.6 11.8C14.1 11.6 14.5 11.3 14.7 11.1C14.9 10.9 15.2 10.6 15.5 10.3C15.8 10 15.9 9.80003 15.9 9.70003C15.9 9.60003 16.1 9.60004 16.3 9.60004C16.5 9.60004 16.7 9.70003 16.8 9.80003C16.9 9.90003 17 10.2 17 10.5V17.2C17 18 16.7 18.4 16.2 18.4C16 18.4 15.8 18.3 15.6 18.2C15.4 18.1 15.3 17.8 15.3 17.5Z"
																							fill="black" />
																					</svg>
																				</span>
																				<!--end::Svg Icon-->
																				<input class="form-control form-control-solid ps-12" name="date_proposed" placeholder="Pick a date" id="date_proposed_id" />
																			</div>
	
	
																		</div>
		
																		<div class="row mb-6">
																			<!--begin::Col-->
																			<div class="col-xl-2">
																				<div class="fs-7 fw-bold mt-2 mb-3">Notes:</div>
																			</div>
																			<!--end::Col-->
																			<!--begin::Col-->
																			<div class="col-xl-9 fv-row">
																				<textarea id="textareaNotes" name="notes" class="form-control form-control-solid h-100px" maxlength="2000"></textarea>
																			</div>
																			<!--begin::Col-->
																		</div>
	
																	</div>
																		
																<!--begin::Col-->
																<div id="divAttributes" class="col-lg-6">
	
																</div>
	
															</div>

															<div class="card-title fs-6 fw-bolder">Add images <i class="fas fa-cloud-upload-alt"></i></div><div class="card-title fs-8 fw-bolder"></div>
	
															<div id="divImages">
	
																<table id="tableImages" class="table table-row-dashed table-row-gray-300 align-middle gs-0 gy-4">
																	<thead class="fw-bolder text-muted">																							
																		<tr>																								
																			<th class="align-top" width="50%">Comment</th>																								
																			<th class="align-top" width="30%">Select file</th>
																			<th class="align-top text-center" width="10%">Preview</th>
																			<th class="align-top" width="10%"></th>
																		</tr>
																	</thead>
																	<tbody>
																		<tr class="baseRowImage" style="display:none">																								
																			<td valign="top"><textarea name="image[]" class="form-control form-control-solid h-80px" maxlength="2000"></textarea></td>																								
																			<td valign="top" class="text-center"><input type="file" name="imageFile[]" class="form-control form-control"><input type="hidden" name="imageFileOk[]"></td>
																			<td valign="top" class="text-center"><img class="preview" src="" alt="Preview" style="display:none;"><div class="symbol symbol-100px mb-5 fileUpload" style="display:none;"><img src="/static/images/upload.svg" alt=""></div></td>
																			<td valign="top" class="text-center">
																				<div class="btn btn-icon btn-sm btn-color-gray-400 btn-active-icon-danger me-2 deleteImage" data-bs-toggle="tooltip" data-bs-dismiss="click" title="Delete">
																					<!--begin::Svg Icon | path: icons/duotune/general/gen027.svg-->
																					<span class="svg-icon svg-icon-2">
																						<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none">
																							<path d="M5 9C5 8.44772 5.44772 8 6 8H18C18.5523 8 19 8.44772 19 9V18C19 19.6569 17.6569 21 16 21H8C6.34315 21 5 19.6569 5 18V9Z" fill="black" />
																							<path opacity="0.5" d="M5 5C5 4.44772 5.44772 4 6 4H18C18.5523 4 19 4.44772 19 5V5C19 5.55228 18.5523 6 18 6H6C5.44772 6 5 5.55228 5 5V5Z" fill="black" />
																							<path opacity="0.5" d="M9 4C9 3.44772 9.44772 3 10 3H14C14.5523 3 15 3.44772 15 4V4H9V4Z" fill="black" />
																						</svg>
																					</span>
																					<!--end::Svg Icon-->
																				</div>
																			</td>
																		</tr>																							
																	</tbody>
																</table>
																<!-- Enlace para agregar nuevas filas -->
																<a href="javascript:void(0);" id="addImage">Add image (+)</a>																				
	
															</div>


															<div class="separator separator-dashed mt-9 mb-6"></div>



															<div class="card-title fs-6 fw-bolder">Add materials <i class="fas fa-cloud-upload-alt"></i></div>
															<div id="messageMaterial">
																
															</div>

															<div id="divMaterials">

																<table id="tableMaterials" class="table table-row-dashed table-row-gray-300 align-middle gs-0 gy-4">
																	<thead class="fw-bolder text-muted">																							
																		<tr>																								
																			<th class="align-top" width="30%">Name</th>
																			<th class="align-top" width="20%">Estimated quantity</th>																								
																			<th class="align-top" width="30%">Select file (optional)</th>
																			<th class="align-top text-center" width="10%">Preview</th>
																			<th class="align-top" width="10%"></th>
																		</tr>
																	</thead>
																	<tbody>
																		<tr class="baseRow" style="display:none">																								
																			<td valign="top"><input type="text" name="material[]" class="form-control form-control-solid autocompleteMaterial"></td>
																			<td valign="top"><input type="text" name="materialQTY[]" class="form-control form-control-solid"></td>
																			<td valign="top" class="text-center"><input type="file" name="materialFile[]" class="form-control form-control"><input type="hidden" name="materialFileOk[]"></td>
																			<td valign="top" class="text-center"><img class="preview" src="" alt="Preview" style="display:none;"><div class="symbol symbol-100px mb-5 fileUpload" style="display:none;"><img src="/static/images/upload.svg" alt=""></div></td>
																			<td valign="top" class="text-center">
																				<div class="btn btn-icon btn-sm btn-color-gray-400 btn-active-icon-danger me-2 deleteMaterial" data-bs-toggle="tooltip" data-bs-dismiss="click" title="Delete">
																					<!--begin::Svg Icon | path: icons/duotune/general/gen027.svg-->
																					<span class="svg-icon svg-icon-2">
																						<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none">
																							<path d="M5 9C5 8.44772 5.44772 8 6 8H18C18.5523 8 19 8.44772 19 9V18C19 19.6569 17.6569 21 16 21H8C6.34315 21 5 19.6569 5 18V9Z" fill="black" />
																							<path opacity="0.5" d="M5 5C5 4.44772 5.44772 4 6 4H18C18.5523 4 19 4.44772 19 5V5C19 5.55228 18.5523 6 18 6H6C5.44772 6 5 5.55228 5 5V5Z" fill="black" />
																							<path opacity="0.5" d="M9 4C9 3.44772 9.44772 3 10 3H14C14.5523 3 15 3.44772 15 4V4H9V4Z" fill="black" />
																						</svg>
																					</span>
																					<!--end::Svg Icon-->
																				</div>
																			</td>
																		</tr>
																	</tbody>
																</table>
																<!-- Enlace para agregar nuevas filas -->
																<a href="javascript:void(0);" id="addMaterial">Add material (+)</a>
	
															</div>
																				
															<br/><br/>
															
															<input id="wo_id" name="wo_id" type="hidden" value="" readonly/>
															
															<div class="card-footer d-flex justify-content-end py-6 px-9">
																<button id="reset" type="reset" class="btn btn-light btn-active-light-primary me-2 px-8 py-2 mr-4" onclick="cleanItemForm()" data-bs-dismiss="modal">Cancel</button>
																
																<button type="submit" class="btn btn-primary px-8 py-2 mr-4" id="submitItem" data-kt-indicator="off">
																	<span class="indicator-label">Save</span>
																	<span class="indicator-progress">Please wait...
																	<span class="spinner-border spinner-border-sm align-middle ms-2"></span></span>
																</button>
															</div>						
														</div>							
													</form>

																																																												
												</div>
												<!--end::Modal body-->																	
											</div>
											<!--end::Modal content-->
										</div>
										<!--end::Modal dialog-->
									</div>
									<!--end::Modal - Add Item-->
								</div>
								<!--end::Container-->
							</div>
							<!--end::Modal Item-->

							<!--begin::Modal Comment-->							
							<div class="modal fade" id="modalComment" tabindex="-1" aria-hidden="true"> <!-- aria-hidden="true" -->
								<!--begin::Modal dialog-->
								<div class="modal-dialog modal-dialog-centered mw-650px">
									<!--begin::Modal content-->
									<div class="modal-content">
										<!--begin::Modal header-->
										<div class="modal-header border-0 justify-content-end">
											<!--begin::Edit-->
											<div class="btn btn-icon btn-sm btn-color-gray-400 btn-active-icon-danger me-2" data-bs-toggle="tooltip" data-bs-dismiss="click" title="Delete" id="modalCommentDelete">
												<!--begin::Svg Icon | path: icons/duotune/general/gen027.svg-->
												<span class="svg-icon svg-icon-2">
													<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none">
														<path d="M5 9C5 8.44772 5.44772 8 6 8H18C18.5523 8 19 8.44772 19 9V18C19 19.6569 17.6569 21 16 21H8C6.34315 21 5 19.6569 5 18V9Z" fill="black" />
														<path opacity="0.5" d="M5 5C5 4.44772 5.44772 4 6 4H18C18.5523 4 19 4.44772 19 5V5C19 5.55228 18.5523 6 18 6H6C5.44772 6 5 5.55228 5 5V5Z" fill="black" />
														<path opacity="0.5" d="M9 4C9 3.44772 9.44772 3 10 3H14C14.5523 3 15 3.44772 15 4V4H9V4Z" fill="black" />
													</svg>
												</span>
												<!--end::Svg Icon-->
											</div>
											<!--end::Edit-->
											<!--begin::Close-->
											<div class="btn btn-icon btn-sm btn-color-gray-500 btn-active-icon-primary" data-bs-toggle="tooltip" title="Close" data-bs-dismiss="modal">
												<!--begin::Svg Icon | path: icons/duotune/arrows/arr061.svg-->
												<span class="svg-icon svg-icon-1">
													<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none">
														<rect opacity="0.5" x="6" y="17.3137" width="16" height="2" rx="1" transform="rotate(-45 6 17.3137)" fill="black" />
														<rect x="7.41422" y="6" width="16" height="2" rx="1" transform="rotate(45 7.41422 6)" fill="black" />
													</svg>
												</span>
												<!--end::Svg Icon-->
											</div>
											<!--end::Close-->
										</div>
										<!--end::Modal header-->
										<!--begin::Modal body-->
										<div class="modal-body pt-0 pb-20 px-lg-17">
											
											<!--end::Row-->
											<input id="id1" name="id1" type="hidden" value="" readonly/>
											<input id="id2" name="id2" type="hidden" value="" readonly/>
											<input id="id3" name="id3" type="hidden" value="" readonly/>
											<!--begin::Row-->
											<div id="saveItemComment">
																
											</div>
											<!--end::Row-->
										</div>
										<!--end::Modal body-->
									</div>
								</div>
							</div>


							<input id="p_id" name="p_id" type="hidden" value="{{proyect.id}}" readonly/>


						</div>
						<!--end::Container-->
					</div>
					<!--end::Entry-->

				</div>
				<!--end::Content-->					
				<!--begin::Footer-->
				{% include 'footer.html' %}
				<!--end::Footer-->
			</div>
				<!--end::Wrapper-->
		</div>
			<!--end::Page-->
	</div>
	<!--end::Root-->
	
		<!--begin::Scrolltop-->
		<div id="kt_scrolltop" class="scrolltop" data-kt-scrolltop="true">
			<!--begin::Svg Icon | path: icons/duotune/arrows/arr066.svg-->
			<span class="svg-icon">
				<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none">
					<rect opacity="0.5" x="13" y="6" width="13" height="2" rx="1" transform="rotate(90 13 6)"
						fill="black" />
					<path
						d="M12.5657 8.56569L16.75 12.75C17.1642 13.1642 17.8358 13.1642 18.25 12.75C18.6642 12.3358 18.6642 11.6642 18.25 11.25L12.7071 5.70711C12.3166 5.31658 11.6834 5.31658 11.2929 5.70711L5.75 11.25C5.33579 11.6642 5.33579 12.3358 5.75 12.75C6.16421 13.1642 6.83579 13.1642 7.25 12.75L11.4343 8.56569C11.7467 8.25327 12.2533 8.25327 12.5657 8.56569Z"
						fill="black" />
				</svg>
			</span>
			<!--end::Svg Icon-->
		</div>
		<!--end::Scrolltop-->
		<!--end::Main-->
		<!--<script>var hostUrl = "assets/";</script>-->
		<!--begin::Javascript-->
		<!--begin::Global Javascript Bundle(used by all pages)-->

		<script>var KTAppSettings = { "breakpoints": { "sm": 576, "md": 768, "lg": 992, "xl": 1200, "xxl": 1400 }, "colors": { "theme": { "base": { "white": "#ffffff", "primary": "#3699FF", "secondary": "#E5EAEE", "success": "#1BC5BD", "info": "#8950FC", "warning": "#FFA800", "danger": "#F64E60", "light": "#E4E6EF", "dark": "#181C32" }, "light": { "white": "#ffffff", "primary": "#E1F0FF", "secondary": "#EBEDF3", "success": "#C9F7F5", "info": "#EEE5FF", "warning": "#FFF4DE", "danger": "#FFE2E5", "light": "#F3F6F9", "dark": "#D6D6E0" }, "inverse": { "white": "#ffffff", "primary": "#ffffff", "secondary": "#3F4254", "success": "#ffffff", "info": "#ffffff", "warning": "#ffffff", "danger": "#ffffff", "light": "#464E5F", "dark": "#ffffff" } }, "gray": { "gray-100": "#F3F6F9", "gray-200": "#EBEDF3", "gray-300": "#E4E6EF", "gray-400": "#D1D3E0", "gray-500": "#B5B5C3", "gray-600": "#7E8299", "gray-700": "#5E6278", "gray-800": "#3F4254", "gray-900": "#181C32" } }, "font-family": "Poppins" };</script>

		<!-- <script src="{% static 'js/jquery.min.js' %}"></script> -->



		<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@simonwep/pickr/dist/themes/classic.min.css">

		<style>
			#color-picker-container {
				margin: 20px;
			}
	
			#selected-color {
				width: 30px;
				height: 30px;
				border-radius: 4px;
				border: 1px solid #ddd;
			}
		</style>

		<script src="{% static 'js/jquery-3.7.1.js' %}"></script>				
		<script src="{% static 'js/plugins.bundle.js' %}"></script>
		<script src="{% static 'js/scripts.bundle.js' %}"></script>
		
		
		
		<script src="{% static 'js/jquery-ui.js' %}"></script>

		<script src="{% static 'js/settingsView.js' %}"></script>

		
		<script src="{% static 'js/galery/jquery.fancybox.js' %}"></script>
		<script src="{% static 'js/galery/gallery.js' %}"></script>
		
				
		<script src="{% static 'js/jquery.mask.min.js' %}"></script>		
		<script src="{% static 'js/galery/imagesloaded.pkgd.min.js' %}"></script>
		<script src="{% static 'js/galery/isotope.pkgd.min.js' %}"></script>
		<script src="{% static 'js/galery/masonry.pkgd.min.js' %}"></script>
		
		<script src="https://cdn.jsdelivr.net/npm/@simonwep/pickr/dist/pickr.min.js"></script>


		<script>
						
			var div = document.getElementById('kt_activities_toggle');
			div.parentNode.remove();	

			$(document).ready(function () {

				autoCompleteReload();

				// $("#inputQty").mask('0000'); // Formato de número 4 digitos	
				$('.grid-gallery').masonry_gallery();
				$("#date_proposed_id").flatpickr({ enableTime: false, dateFormat: "Y-m-d" });
				
				flatpickr(".receivedDate", {
					dateFormat: "Y/m/d", // formato deseado
					allowInput: true     // permite escribir manualmente si lo necesitas
				});
								
				initializeFlatpickr();

				$('#aAddItem').click(function() {
					cleanItemForm();					
				});


				$('#addMaterial').click(function() {
					// Clonamos la fila con id "filaBase"					
					var newRow = $('.baseRow:first').clone();										
					newRow.find('input').val('');      					
					newRow.find('.previewMaterial').hide();					
					newRow.removeAttr('style');
					newRow.removeAttr('id');

					$('#tableMaterials tbody').append(newRow);

					autoCompleteReload();
				});

				$('#addImage').click(function() {
					// Clonamos la fila con id "filaBase"					
					var newRow = $('.baseRowImage:first').clone();										
					newRow.find('input').val('');      					
					newRow.find('.previewImage').hide();					
					newRow.removeAttr('style');
					newRow.removeAttr('id');

					$('#tableImages tbody').append(newRow);					
				});

				$(document).on('click', '.deleteMaterial', function() {
      				$(this).closest('tr').remove();  // Elimina la fila correspondiente
    			});

				$(document).on('click', '.deleteImage', function() {
      				$(this).closest('tr').remove();  // Elimina la fila correspondiente
    			});


				$('#tableMaterials').on('change', 'input[type="file"]', function(event) {
					var input = $(this)[0];
					var file = input.files[0];

					// Solo procesamos si el archivo es una imagen
					if (file && file.type.match('image.*')) {
						var reader = new FileReader();

						reader.onload = function(e) {
						// Mostrar la imagen en la vista previa
							$(input).closest('tr').find('.preview').attr('src', e.target.result).show();
							$(input).closest('tr').find('.fileUpload').hide();
						};

						reader.readAsDataURL(file);
					} else {
						// Si no es una imagen, ocultar la vista previa
						$(input).closest('tr').find('.preview').hide();
						$(input).closest('tr').find('.fileUpload').show();
					}
				});

				$('#tableImages').on('change', 'input[type="file"]', function(event) {
					var input = $(this)[0];
					var file = input.files[0];

					// Solo procesamos si el archivo es una imagen
					if (file && file.type.match('image.*')) {
						var reader = new FileReader();

						reader.onload = function(e) {
						// Mostrar la imagen en la vista previa
							$(input).closest('tr').find('.preview').attr('src', e.target.result).show();
							$(input).closest('tr').find('.fileUpload').hide();
						};

						reader.readAsDataURL(file);
					} else {
						// Si no es una imagen, ocultar la vista previa
						$(input).closest('tr').find('.preview').hide();
						$(input).closest('tr').find('.fileUpload').show();
					}
				});

				
				$('#modalItem').modal({
					backdrop: 'static',  // No permitir cierre al hacer clic fuera del modal
					keyboard: false      // No permitir cierre con la tecla Esc
				});

				$('#selectCategory').change(function() {
					loadSubcategory(0,0);
					loadAttributes();
					loadGroup(0);
				});

				$('#selectSubcategory').change(function() {
					loadGroup(0);
				});


				document.querySelectorAll('.formQuote').forEach(form => {					
					
					form.addEventListener('submit', function(e) {
						e.preventDefault(); // Evita el envío tradicional
						const formData = new FormData(form);
						
						$.ajax({
						  type: "POST",
						  url: "{% url 'saveQuote_url' %}",  // Reemplaza con la URL de tu vista
						  data: formData,
						  processData: false,  // Esto es importante para enviar archivos correctamente
						  contentType: false,  // Evitar que jQuery configure el tipo de contenido automáticamente
						  beforeSend: function(xhr, settings) {
							  // Añadir el token CSRF en las cabeceras
							  xhr.setRequestHeader('X-CSRFToken', $('meta[name="csrf-token"]').attr('content'));
						  },
						  success: function(response) {
							  if(response.result = "OK"){

								toastr.options = {
									"closeButton": true,
									"progressBar": true,
									"positionClass": "toast-top-right",
									"timeOut": "3000"
								};

								toastr.success("Data saved successfully!");
							  }						
						  },
						  error: function() {
							  console.error("Error server: " + error, event.error);
						  }
					  });
					  
					});

				});


				document.querySelectorAll('.formMaterial').forEach(form => {					
					
					form.addEventListener('submit', function(e) {
						e.preventDefault(); // Evita el envío tradicional
						const formData = new FormData(form);
						
						$.ajax({
						  type: "POST",
						  url: "{% url 'saveMaterial_url' %}",  // Reemplaza con la URL de tu vista
						  data: formData,
						  processData: false,  // Esto es importante para enviar archivos correctamente
						  contentType: false,  // Evitar que jQuery configure el tipo de contenido automáticamente
						  beforeSend: function(xhr, settings) {
							  // Añadir el token CSRF en las cabeceras
							  xhr.setRequestHeader('X-CSRFToken', $('meta[name="csrf-token"]').attr('content'));
						  },
						  success: function(response) {
							  if(response.result = "OK"){

								toastr.options = {
									"closeButton": true,
									"progressBar": true,
									"positionClass": "toast-top-right",
									"timeOut": "3000"
								};

								toastr.success("Data saved successfully!");
							  }						
						  },
						  error: function() {
							  console.error("Error server: " + error, event.error);
						  }
					  });
					  
					});

				});

					

			});

			




			function autoCompleteReload(){
				
				$('.autocompleteMaterial').autocomplete({
					source: function(request, response) {								
								// Enviar la solicitud AJAX al servidor
								$.ajax({
									url: "{% url 'getDataMaterial_url' %}",  // La URL que manejará la consulta AJAX
									method: 'GET',
									dataType: 'json',  // Esperamos recibir una respuesta en formato JSON
									data: {
										'term': request.term  // "term" es el texto que el usuario ha ingresado en el input
									},
									success: function(data) {
									// Pasar las sugerencias a la función `response()`
										console.log("Datos recibidos: ", data);
										response(data);
									}
								});
							},
					minLength: 2,  // Mínimo de caracteres antes de realizar la búsqueda
				});
			}


			function pickeColorReload(){

				const pickr = Pickr.create({
				el: '#color-picker',
				theme: 'classic', // Usamos el estilo clásico, pero puedes elegir entre 'classic', 'monolith', 'nano'
	
				// Configuración de los colores
				swatches: [
					'#FF5733', '#33FF57', '#3357FF', '#F5A623', '#8E44AD', '#F00', '#0F0', '#00F', '#000'
				],
	
				// Configuración de la paleta de colores
				default: '#009ef7', // Color inicial predeterminado
	
				components: {
					// Añadir la paleta de colores
					preview: true,  // Muestra una vista previa
					//opacity: true,  // Muestra control de opacidad
					//hue: true,      // Muestra el control de tono (hue)
					// interaction: {
					// 	hex: true,   // Muestra el valor HEX
					// 	rgba: true,  // Muestra el valor RGBA
					// 	hsla: true,  // Muestra el valor HSLA
					// 	input: true  // Permite introducir valores manualmente
					// }
					cancel: true,   // Muestra el botón de cancelar selección

					// Botón para guardar el color seleccionado
					save: true,   
				},
				
			});
	
			// Muestra el color seleccionado en el contenedor
			pickr.on('change', (color) => {
				// Obtener el color HEX y mostrarlo
				const hexColor = color.toHEXA().toString();
				document.getElementById('selected-color').style.backgroundColor = hexColor;

				document.getElementById('color-picker').style.backgroundColor = hexColor;
				pickeColorReload();
			});

			}

			
			function loadSubcategory(i,g){	
				var selectValue = $("#selectCategory").val();			
								
				if(selectValue != "" ) {				

					$.ajax({
						url: "{% url 'getSelectSubcategory_url' %}",  // La URL que manejará la consulta AJAX
						method: 'POST',
						data: {
							'categorySelect': selectValue  // El valor que se envía al servidor
						},
						beforeSend: function(xhr, settings) {
							// Añadir el token CSRF en las cabeceras
							xhr.setRequestHeader('X-CSRFToken', $('meta[name="csrf-token"]').attr('content'));
						},
						success: function(response) {
							// Rellena los campos con los datos obtenidos de la respuesta
							$('#selectSubcategory').html(response.result);

							if ($('#selectSubcategory option[value="' + i + '"]').length > 0) {
								$('#selectSubcategory').val(i);  // Establecer el valor
							}

							// if(g > 0){
							// 	loadGroup(g)
							// }
							loadGroup($('#selectSubcategory option:first').val())

						},
						error: function(xhr, status, error) {
							console.error("Error server: " + error, event.error);							
						}
					});				
					
				}

			}


			function loadGroup(i){	
								
				var selectValue = $("#selectSubcategory").val();
								
				if(selectValue != "") {				

					$.ajax({
						url: "{% url 'getSelectGroup_url' %}",  // La URL que manejará la consulta AJAX
						method: 'POST',
						data: {							
							'subcategorySelect': selectValue
						},
						beforeSend: function(xhr, settings) {
							// Añadir el token CSRF en las cabeceras
							xhr.setRequestHeader('X-CSRFToken', $('meta[name="csrf-token"]').attr('content'));
						},
						success: function(response) {
							// Rellena los campos con los datos obtenidos de la respuesta
							$('#selectGroup').html(response.result);

							if ($('#selectGroup option[value="' + i + '"]').length > 0) {
								$('#selectGroup').val(i);  // Establecer el valor
							}
						},
						error: function(xhr, status, error) {
							console.error("Error server: " + error, event.error);							
						}
					});				
					
				}

			}


			function loadAttributes(){	
				var selectValue = $("#selectCategory").val();			
								
				if(selectValue != "" ) {				

					$.ajax({
						url: "{% url 'getSelectAttribute_url' %}",  // La URL que manejará la consulta AJAX
						method: 'POST',
						data: {
							'categorySelect': selectValue  // El valor que se envía al servidor
						},
						beforeSend: function(xhr, settings) {
							// Añadir el token CSRF en las cabeceras
							xhr.setRequestHeader('X-CSRFToken', $('meta[name="csrf-token"]').attr('content'));
						},
						success: function(response) {
							// Rellena los campos con los datos obtenidos de la respuesta
							$('#divAttributes').html(response.result);
							initializeSelect2();
						},
						error: function(xhr, status, error) {
							console.error("Error server: " + error, event.error);							
						}
					});				
					
				}

			}


			function loadWOs(){
				var selectValue = $("#p_id").val();			
								
				if(selectValue != "") {				

					$.ajax({
						url: "{% url 'getSelectWOs_url' %}",  // La URL que manejará la consulta AJAX
						method: 'POST',
						data: {
							'p': selectValue,
							'm': 1  // El valor que se envía al servidor
						},
						beforeSend: function(xhr, settings) {
							// Añadir el token CSRF en las cabeceras
							xhr.setRequestHeader('X-CSRFToken', $('meta[name="csrf-token"]').attr('content'));
						},
						success: function(response) {
							// Rellena los campos con los datos obtenidos de la respuesta
							$('#wosDetails').html(response.result);
							$('.grid-gallery').masonry_gallery();							
							$('html, body').animate({ scrollTop: 0 }, 'fast');
							cleanItemForm();
							showImgs();
						},
						error: function(xhr, status, error) {
							console.error("Error server: " + error, event.error);
						}
					});
				}
			}
			

			function delI(o,i){

				Swal.fire({
					title: 'Are you sure?',
					text: 'This action will delete the item. Do you want to continue?',
					icon: 'warning',
					showCancelButton: true,  // Muestra el botón de cancelación
					confirmButtonText: 'Yes',
					cancelButtonText: 'Cancel'
				}).then((result) => {
					if (result.isConfirmed) {
						// Si el usuario confirma, se ejecuta la acción AJAX
						$.ajax({
							url: "{% url 'deleteItem_url' %}",  // La URL que manejará la consulta AJAX
							method: 'POST',
							data: {
								'i': i  // El valor que se envía al servidor
							},
							beforeSend: function(xhr, settings) {
								// Añadir el token CSRF en las cabeceras
								xhr.setRequestHeader('X-CSRFToken', $('meta[name="csrf-token"]').attr('content'));
							},
							success: function(response) {
								// Rellena los campos con los datos obtenidos de la respuesta
								if(response.result == "1"){
									// loadWOs();
									// $('.grid-gallery').masonry_gallery();

									var item = o.parentNode.parentNode.parentNode.parentNode.parentNode;
									item.remove();

									Swal.fire({
										title: 'Deleted!',
										text: 'The item has been successfully deleted.',
										icon: 'info',
										confirmButtonText: 'Ok.'
									});
								}

								
							},
							error: function(xhr, status, error) {																
								Swal.fire({
										title: 'Error server!',
										text: error,
										icon: 'error',
										confirmButtonText: 'Ok.'
									});

							}
						});	
					}
				});
			}


			function cleanItemForm(){

				var select = document.getElementById('selectCategory');
				select.selectedIndex = 0; // Establece el primer elemento como seleccionado

				var select = document.getElementById('selectPlace');
				select.selectedIndex = 0; // Establece el primer elemento como seleccionado

				var select = document.getElementById('selectSubcategory');
				select.innerHTML = ''; // Establece el primer elemento como seleccionado

				var select = document.getElementById('selectGroup');
				select.innerHTML = ''; // Establece el primer elemento como seleccionado

				$('#modalItem').hide();

				$('#inputQty').val('');
				$('#date_proposed_id').val('');

				$('#selectSubcategory').html('');
				$('#divAttributes').html('');

				$("#tableMaterials tbody tr:not(:first)").remove();
				$("#tableImages tbody tr:not(:first)").remove();
				
			}


			function showImgs(){
							
				$('.showImg').each(function() {					
					$(this).click();
				});
			}


			function state(w,e){

				var state = document.querySelector('#stateAfter').value;
				var cant = validateState(w,e).c;
				var txt = validateState(w,e).m;
				
				if(cant > 0){

					//var state = "next";
					Swal.fire({
						title: 'Are you sure?',
						text: 'Do you want to advance to "' + state + '" status?',
						icon: 'warning',
						showCancelButton: true,  // Muestra el botón de cancelación
						confirmButtonText: 'Yes',
						cancelButtonText: 'Cancel'
					}).then((result) => {
						if (result.isConfirmed) {

							$.ajax({
								url: "{% url 'updateStatus_url' %}",  // La URL que manejará la consulta AJAX
								method: 'POST',
								data: {
									'w': w  // El valor que se envía al servidor
								},
								beforeSend: function(xhr, settings) {
									// Añadir el token CSRF en las cabeceras
									xhr.setRequestHeader('X-CSRFToken', $('meta[name="csrf-token"]').attr('content'));
								},
								success: function(response) {
									// Rellena los campos con los datos obtenidos de la respuesta
									if(response.result == "1"){										
										window.location.reload();										
									}									
								},
								error: function(xhr, status, error) {																
									Swal.fire({
											title: 'Error server!',
											text: error,
											icon: 'error',
											confirmButtonText: 'Ok.'
									});
								}
							});
						}
					});
				}
				else{
					Swal.fire({
						title: 'Alert!',
						text: txt,
						icon: 'info',
						confirmButtonText: 'Ok.'
					});
				}
			}


			function createColorCircle(color) {
				return $('<span></span>')
				.addClass('rounded-circle me-2') // Añade clases para darle estilo al círculo
				.css({
					'background-color': color,
					'width': '10px',
					'height': '10px',
					'display': 'inline-block',
					'margin-right': '8px' // Espacio entre el círculo y el texto
				});
			}


			function createImageTag(imageUrl) {
				return $('<img />') // Crea un nuevo elemento <img>
				.attr('src', imageUrl) // Establece la URL de la imagen
				.css({
					'width': '30px', // Establece un tamaño adecuado para la imagen
					'height': '30px', // Ajusta la altura de la imagen
					'margin-right': '8px', // Espacio entre la imagen y el texto
					'border-radius': '10%' // Puedes redondear la imagen si lo deseas
				});
			}


			function initializeSelect2() {
				// Seleccionamos todos los elementos <select> con la clase "select2"
				$('.selectAttribute').select2({
					minimumResultsForSearch: Infinity,
					templateResult: function(data) {
						var imageUrl = $(data.element).data('image'); // Obtener la URL de la imagen
						var container = $('<span></span>').css('display', 'flex').css('align-items', 'center');

						if (imageUrl) {
							// Crear un elemento <img> con la URL de la imagen
							var image = createImageTag(imageUrl);
							container.append(image);  // Añadimos la imagen
						}

						container.append(data.text);  // Añadimos el texto de la opción
						return container;
					},
					templateSelection: function(data) {
						var imageUrl = $(data.element).data('image'); // Obtener la URL de la imagen
						var container = $('<span></span>').css('display', 'flex').css('align-items', 'center');

						if (imageUrl) {
							// Crear un elemento <img> con la URL de la imagen
							var image = createImageTag(imageUrl);
							container.append(image);  // Añadimos la imagen
						}

						container.append(data.text);  // Añadimos el texto de la opción seleccionada
						return container;
					}
				});
			}
		
			
			function loadIC(w, t, i,c){

				$('#saveItemComment').html('');

				$.ajax({
					url: "{% url 'getDataComment_url' %}",  // La URL que manejará la consulta AJAX
					method: 'GET',
					data: {
						'id1': w,
						'id2': t,
						'id3': i,
						'id4': c,
					},		
					success: function(response) {
						$('#saveItemComment').html(response.result);
						initializeFlatpickr();
						// pickeColorReload();						
						
						if(c == 1){							
																					
							$('#selectResponsible').select2({
								minimumResultsForSearch: Infinity,
								templateResult: function(data) {									
									var color = $(data.element).data('color'); // Obtener el color de la opción
									if (color) {
										// Crear un elemento de círculo con el color indicado
										var circle = createColorCircle(color);
										
										var container = $('<span></span>')
											.append(circle)  // Añadimos el círculo
											.append(data.text);  // Añadimos el texto de la opción

										return container;

									}

									return data.text;  // Si no hay color, solo devolvemos el texto
								},
								templateSelection: function(data) {
									var color = $(data.element).data('color'); // Obtener el color de la opción
									if (color) {
										// Crear un elemento de círculo con el color indicado
										var circle = createColorCircle(color);
										
										var container = $('<span></span>')
											.append(circle)  // Añadimos el círculo
											.append(data.text);  // Añadimos el texto de la opción

										return container;

									}
								}
							});
						}
					},
					error: function() {
						console.error("Error server: " + error, event.error);
					}
				});
				}

			
			function saveIC(w,i,c){

				var txt = $('#formItem_' + String(i) + ' textarea')[0];  // Seleccionamos el input dentro de form1
				var texto = txt.value;
								
				if(texto != ""){					
					var formData = new FormData();  // Creamos un objeto FormData vacío
					formData.append('id1', 0);
					formData.append('id1', w);
					formData.append('id2', i);
					formData.append('id3', c);
					// Serializamos los datos del formulario (excepto los archivos)
					var serializedData = $('#formItem_' + String(i)).serialize();
								
					// Convertimos los datos serializados en un objeto y lo agregamos al FormData
					var params = serializedData.split('&');
					params.forEach(function(param) {
						var keyValue = param.split('=');
						var key = decodeURIComponent(keyValue[0]);
						var value = decodeURIComponent(keyValue[1] || '');
						formData.append(key, value);
					});

					var inputFile = $('#formItem_' + String(i) + ' input[type="file"]')[0];  // Seleccionamos el input dentro de form1
					
					if (inputFile && inputFile.files.length > 0) {

						for (var i = 0; i < inputFile.files.length; i++) {
							formData.append('files[]', inputFile.files[i]); // Usamos '[]' para manejar múltiples archivos
						}
					}
				
					$.ajax({
						type: "POST",
						url: "{% url 'saveItemComment_url' %}",  // Reemplaza con la URL de tu vista
						data: formData,
						processData: false,  // Esto es importante para enviar archivos correctamente
						contentType: false,  // Evitar que jQuery configure el tipo de contenido automáticamente
						beforeSend: function(xhr, settings) {
							// Añadir el token CSRF en las cabeceras
							xhr.setRequestHeader('X-CSRFToken', $('meta[name="csrf-token"]').attr('content'));
						},
						success: function(response) {
							if(response.result = "OK"){								
								loadWOs();
								$('#modalComment').modal('hide');


								toastr.options = {
									"closeButton": true,
									"progressBar": true,
									"positionClass": "toast-top-right",
									"timeOut": "3000"
								};

								toastr.success("The comment has been saved successfully!");
								
								// $('#messageSave').show();								
								// $('#messageSave').html('<div class="alert alert-success alert-dismissible fade show" role="alert">The <strong>comment</strong> has been saved successfully.<button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button></div>');								
								// setTimeout(function() {
								// 	$('#messageSave').fadeOut(); // Esto hará que el div se desvanezca
								// }, 3000); 
							}						
						},
						error: function() {
							console.error("Error server: " + error, event.error);
						}
					});
				}
				else{
					const divWithClass = $('#formItem_'+ String(i) +' .divItemMsg');
					divWithClass.show();
					divWithClass.fadeOut(5000);
				}

			}


			function saveIR(w,i){
								
				var formData = new FormData();  // Creamos un objeto FormData vacío
				formData.append('id1', w);
				formData.append('id2', i);				
				// Serializamos los datos del formulario (excepto los archivos)
				var serializedData = $('#formItem_' + String(i)).serialize();
							
				// Convertimos los datos serializados en un objeto y lo agregamos al FormData
				var params = serializedData.split('&');
				params.forEach(function(param) {
					var keyValue = param.split('=');
					var key = decodeURIComponent(keyValue[0]);
					var value = decodeURIComponent(keyValue[1] || '');
					formData.append(key, value);
				});

				var inputFile = $('#formItem_' + String(i) + ' input[type="file"]')[0];  // Seleccionamos el input dentro de form1
				
				if (inputFile && inputFile.files.length > 0) {

					for (var i = 0; i < inputFile.files.length; i++) {
						formData.append('files[]', inputFile.files[i]); // Usamos '[]' para manejar múltiples archivos
					}
				}

				$.ajax({
					type: "POST",
					url: "{% url 'saveItemComment_url' %}",  // Reemplaza con la URL de tu vista
					data: formData,
					processData: false,  // Esto es importante para enviar archivos correctamente
					contentType: false,  // Evitar que jQuery configure el tipo de contenido automáticamente
					beforeSend: function(xhr, settings) {
						// Añadir el token CSRF en las cabeceras
						xhr.setRequestHeader('X-CSRFToken', $('meta[name="csrf-token"]').attr('content'));
					},
					success: function(response) {
						if(response.result = "OK"){								
							loadWOs();
							$('#modalComment').modal('hide');

							toastr.options = {
									"closeButton": true,
									"progressBar": true,
									"positionClass": "toast-top-right",
									"timeOut": "3000"
								};

							toastr.success("The date has been saved successfully!");
							
							// $('#messageSave').show();								
							// $('#messageSave').html('<div class="alert alert-success alert-dismissible fade show" role="alert">The <strong>date</strong> has been saved successfully.<button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button></div>');								
							// setTimeout(function() {
							// 	$('#messageSave').fadeOut(); // Esto hará que el div se desvanezca
							// }, 3000); 
						}						
					},
					error: function() {
						console.error("Error server: " + error, event.error);
					}
				});


			}

			
			function delFile(o,i,t,e,w,v){

				v.preventDefault();
				v.stopPropagation();

				Swal.fire({
					title: 'Are you sure?',
					text: 'Do you want to delete the file?',
					icon: 'warning',
					showCancelButton: true,  // Muestra el botón de cancelación
					confirmButtonText: 'Yes',
					cancelButtonText: 'Cancel'
				}).then((result) => {
					if (result.isConfirmed) {																		
												
						$.ajax({					
							url: "{% url 'deleteItemCommentFile_url' %}",  // La URL que manejará la consulta AJAX
							method: 'POST',
							data: {
								'i': i,
								't': t,
								'w': w,
								'e': e
							},
							beforeSend: function(xhr, settings) {
								// Añadir el token CSRF en las cabeceras
								xhr.setRequestHeader('X-CSRFToken', $('meta[name="csrf-token"]').attr('content'));
							},
							success: function(response) {
								// Rellena los campos con los datos obtenidos de la respuesta
								if(response.result == "1"){
									const pad = o.parentNode;
									pad.remove();
									loadWOs();
								}						
							},
							error: function(xhr, status, error) {																
								Swal.fire({
										title: 'Error server!',
										text: error,
										icon: 'error',
										confirmButtonText: 'Ok.'
									});

							}
						});	
					}
				});
				
			}


			function initializeFlatpickr() {
				// Aplicar flatpickr a los inputs con la clase 'date-picker'
				$(".date-picker").flatpickr({
					enableTime: true, // Deshabilitar la selección de hora
					dateFormat: "Y-m-d H:i" // Establecer el formato de fecha
				});
			}

			
			function delComm(t,e,w,v){

				v.preventDefault();
				v.stopPropagation();

				Swal.fire({
					title: 'Are you sure?',
					text: 'Do you want to delete the comment?',
					icon: 'warning',
					showCancelButton: true,  // Muestra el botón de cancelación
					confirmButtonText: 'Yes',
					cancelButtonText: 'Cancel'
				}).then((result) => {
					if (result.isConfirmed) {																		
												
						$.ajax({					
							url: "{% url 'deleteComment_url' %}",  // La URL que manejará la consulta AJAX
							method: 'POST',
							data: {
								't': t,
								'w': w,
								'e': e
							},
							beforeSend: function(xhr, settings) {
								// Añadir el token CSRF en las cabeceras
								xhr.setRequestHeader('X-CSRFToken', $('meta[name="csrf-token"]').attr('content'));
							},
							success: function(response) {
								// Rellena los campos con los datos obtenidos de la respuesta
								if(response.result = "1"){								
									loadWOs();
									$('#modalComment').modal('hide');

									toastr.options = {
										"closeButton": true,
										"progressBar": true,
										"positionClass": "toast-top-right",
										"timeOut": "3000"
									};

									toastr.success("The comment has been deleted successfully!");

									// $('#messageSave').show();								
									// $('#messageSave').html('<div class="alert alert-success alert-dismissible fade show" role="alert">The <strong>comment</strong> has been deleted successfully.<button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button></div>');								
									// setTimeout(function() {
									// 	$('#messageSave').fadeOut(); // Esto hará que el div se desvanezca
									// }, 3000);

								}
								else{
									Swal.fire({
										title: 'Error server!',
										text: error,
										icon: 'error',
										confirmButtonText: 'Ok.'
									});
								}

							},
							error: function(xhr, status, error) {																
								Swal.fire({
										title: 'Error server!',
										text: error,
										icon: 'error',
										confirmButtonText: 'Ok.'
									});
							}
						});	
					}
				});
			}
			

			function editItem(w,i){
				cleanItemForm();
				$('#modalItem').modal('show');

				var formData = new FormData();  // Creamos un objeto FormData vacío
				formData.append('w', w);
				formData.append('i', i);

				$.ajax({
					type: "POST",
					url: "{% url 'getDataItem_url' %}",  // Reemplaza con la URL de tu vista
					data: formData,
					processData: false,  // Esto es importante para enviar archivos correctamente
					contentType: false,  // Evitar que jQuery configure el tipo de contenido automáticamente
					beforeSend: function(xhr, settings) {
						// Añadir el token CSRF en las cabeceras
						xhr.setRequestHeader('X-CSRFToken', $('meta[name="csrf-token"]').attr('content'));
						$('#please_wait_message').show();
                        $('#divItem').hide();
					},					
					success: function(response) {
						$('#selectCategory').val(response.category);
						loadSubcategory(response.subCategory,response.group);						
						$('#selectPlace').val(response.place);
						$('#selectPlace').val(response.place);
						$('#inputQty').val(response.qty);
						$('#textareaNotes').val(response.notes);
						$('#date_proposed_id').val(response.date);
						$('#divAttributes').html(response.attributes);
						$('#tableMaterials').append(response.materials);
						$('#tableImages').append(response.images);

						autoCompleteReload();

					},
					error: function() {
						Swal.fire({
							title: 'Error!',
							text: 'Server error. Please contact to administrator!',
							icon: 'error',							
							confirmButtonText: 'Ok',							
						}).then((result) => {
							console.error("Error server: " + error, event.error);
						});	
													
					},
					complete: function() {
                        $('#please_wait_message').hide();
                        $('#divItem').show();
                    }
				});

				// var txt = $('#formItem_' + String(i) + ' textarea')[0];  // Seleccionamos el input dentro de form1
				// var texto = txt.value;
								
				// if(texto != ""){					
				// 	var formData = new FormData();  // Creamos un objeto FormData vacío
				// 	formData.append('id1', p);
				// 	formData.append('id2', i);
				// 	formData.append('id3', c);
				// 	// Serializamos los datos del formulario (excepto los archivos)
				// 	var serializedData = $('#formItem_' + String(i)).serialize();
								
				// 	// Convertimos los datos serializados en un objeto y lo agregamos al FormData
				// 	var params = serializedData.split('&');
				// 	params.forEach(function(param) {
				// 		var keyValue = param.split('=');
				// 		var key = decodeURIComponent(keyValue[0]);
				// 		var value = decodeURIComponent(keyValue[1] || '');
				// 		formData.append(key, value);
				// 	});

				// 	var inputFile = $('#formItem_' + String(i) + ' input[type="file"]')[0];  // Seleccionamos el input dentro de form1
					
				// 	if (inputFile && inputFile.files.length > 0) {

				// 		for (var i = 0; i < inputFile.files.length; i++) {
				// 			formData.append('files[]', inputFile.files[i]); // Usamos '[]' para manejar múltiples archivos
				// 		}
				// 	}

				// 	$.ajax({
				// 		type: "POST",
				// 		url: "{% url 'saveItemComment_url' %}",  // Reemplaza con la URL de tu vista
				// 		data: formData,
				// 		processData: false,  // Esto es importante para enviar archivos correctamente
				// 		contentType: false,  // Evitar que jQuery configure el tipo de contenido automáticamente
				// 		beforeSend: function(xhr, settings) {
				// 			// Añadir el token CSRF en las cabeceras
				// 			xhr.setRequestHeader('X-CSRFToken', $('meta[name="csrf-token"]').attr('content'));
				// 		},
				// 		success: function(response) {
				// 			if(response.result = "OK"){								
				// 				loadWOs();
				// 				$('#modalComment').modal('hide');
								
				// 				$('#messageSave').show();								
				// 				$('#messageSave').html('<div class="alert alert-success alert-dismissible fade show" role="alert">The <strong>comment</strong> has been saved successfully.<button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button></div>');								
				// 				setTimeout(function() {
				// 					$('#messageSave').fadeOut(); // Esto hará que el div se desvanezca
				// 				}, 3000); 
				// 			}						
				// 		},
				// 		error: function() {
				// 			console.error("Error server: " + error, event.error);
				// 		}
				// 	});
				// }
				// else{
				// 	const divWithClass = $('#formItem_'+ String(i) +' .divItemMsg');
				// 	divWithClass.show();
				// 	divWithClass.fadeOut(5000);
				// }

			}

			
			function validateState(w,e){

				c = 0;		
				m = '';						
				if (e == 1) {
					c = $('.itemCount_' + w).length;
					m = 'You must add items.';
				}

				if (e == 2) {										
					$('.itemCount_' + w).each(function() {
						if ($(this).find('.state_2').length > 0) {
							c++;
						}
					});
					
					if ($('.itemCount_' + w).length != c){
						c = 0;
					}
					
					if (c == 0){
						c = $('.state_G_2_' + w).length;
					}

					m = 'You must enter quotes for each item.';
				}

				if (e == 3) {										
					// $('.itemCount_' + w).each(function() {
					// 	if ($(this).find('.approve:checked').length > 0) {
					// 		c++;
					// 	}
					// });
					
					// if ($('.itemCount_' + w).length != c){
					// 	c = 0;
					// }

					// m = 'You must approve the quote for each item.';
					c = 1
				}

				if (e == 4) {										
					// $('.itemCount_' + w).each(function() {
					// 	$(this).find('input.materialOK:checked').each(function() {
					// 		c++;
					// 	});
					// });
					
					// if ($('.materialOK').length != c){
					// 	c = 0;
					// }

					// m = 'You must check all the materials.';
					c = 1
					
				}


				return {c, m}
			}
			

			function wo(i){
				$('#wo_id').val(i);
			}


			function addWO(p){

				Swal.fire({
					title: 'Are you sure?',
					text: 'Do you want to create a new work order?',
					icon: 'warning',
					showCancelButton: true,  // Muestra el botón de cancelación
					confirmButtonText: 'Yes',
					cancelButtonText: 'Cancel'
				}).then((result) => {
					if (result.isConfirmed) {																		
												
						$.ajax({					
							url: "{% url 'addWorkOrder_url' %}",  // La URL que manejará la consulta AJAX
							method: 'POST',
							data: {
								'p': p								
							},
							beforeSend: function(xhr, settings) {
								// Añadir el token CSRF en las cabeceras
								xhr.setRequestHeader('X-CSRFToken', $('meta[name="csrf-token"]').attr('content'));
							},
							success: function(response) {
								// Rellena los campos con los datos obtenidos de la respuesta
								if(response.result != -1){									
									loadWOs();

									Swal.fire({
										title: 'The new work order has been successfully created!',
										text: error,
										icon: 'info',
										confirmButtonText: 'Ok.'
									});
								}
								else{
									Swal.fire({
										title: 'Error server!',
										text: error,
										icon: 'error',
										confirmButtonText: 'Ok.'
									});
								}	
							},
							error: function(xhr, status, error) {																
								Swal.fire({
										title: 'Error server!',
										text: error,
										icon: 'error',
										confirmButtonText: 'Ok.'
									});

							}
						});	
					}
				});

			}


			// function app(t,i){
			// 	$.ajax({					
					
			// 		url: "{% url 'saveQuote_url' %}",  // La URL que manejará la consulta AJAX
			// 		method: 'POST',
			// 		data: {
			// 			'i': i,
			// 			't': $(t).prop('checked'),				
			// 		},
			// 		beforeSend: function(xhr, settings) {
			// 			// Añadir el token CSRF en las cabeceras
			// 			xhr.setRequestHeader('X-CSRFToken', $('meta[name="csrf-token"]').attr('content'));
			// 		},
			// 		success: function(response) {
						
			// 		},
			// 	});	

			// }
		
		</script>

</body>
<!--end::Body-->

</html>